(this["webpackJsonpreact-login"]=this["webpackJsonpreact-login"]||[]).push([[0],{123:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),s=n(39),r=n.n(s),o=(n(93),n(94),n(18)),i=n(8),l=n(10),j=n(23),u=n(6),d=n(24),b=n(15),h=n(19),O=n(41),x=n.n(O),f=n(51),p=n(32),g=n.n(p),m=n(84),v=n.n(m),k=g.a.create({baseURL:"https://forum-backend.notacannibal.xyz/api/v1",headers:{"Content-Type":"application/json"}});k.interceptors.request.use((function(e){var t=JSON.parse(sessionStorage.getItem("token"));return t&&(e.url.includes("users")||e.url.includes("threads?page"))&&(e.headers.Authorization="Bearer "+t),e}),(function(e){Promise.reject(e)})),k.interceptors.response.use((function(e){return e}),function(){var e=Object(f.a)(x.a.mark((function e(t){var n,a,c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.config,t.response){e.next=3;break}return e.abrupt("return",Promise.reject(t));case 3:if(!n.url.includes("auth")){e.next=5;break}return e.abrupt("return",Promise.reject(t));case 5:if(400!==t.response.status||"http://localhost:8080/api/v1/auth/refresh/token"!==n.url){e.next=8;break}return window.location.href="/login",e.abrupt("return",Promise.reject(t));case 8:if(403!==t.response.status||n._retry){e.next=14;break}return n._retry=!0,"http://localhost:8080/api/v1/auth/refresh/token",a={grant_type:"refresh_token",refresh_token:JSON.parse(sessionStorage.getItem("refresh_token"))},c={method:"POST",headers:{"content-type":"application/x-www-form-urlencoded"},data:v.a.stringify(a),url:"http://localhost:8080/api/v1/auth/refresh/token"},e.abrupt("return",g()(c).then((function(e){if(200===e.status)return console.log(e.data),sessionStorage.setItem("token",JSON.stringify(e.data.access_token)),sessionStorage.setItem("refresh_token",JSON.stringify(e.data.refresh_token)),n.headers.Authorization="Bearer "+JSON.parse(sessionStorage.getItem("token")),g()(n)})));case 14:if("get"!==n.method||404!==t.response.status){e.next=16;break}return e.abrupt("return",t.response);case 16:return e.abrupt("return",Promise.reject(t));case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var S=n(53),y=n(13),w=n(14),C=n(2);function N(e){var t=e.show,n=e.handleClose,a=e.handleDelete,c=e.id,s=e.message;return Object(C.jsx)(C.Fragment,{children:Object(C.jsxs)(w.a,{show:t,onHide:n,children:[Object(C.jsx)(w.a.Header,{closeButton:!0,children:Object(C.jsx)(w.a.Title,{children:"Confirm Delete"})}),Object(C.jsxs)(w.a.Body,{children:[" ",Object(C.jsx)(S.a,{variant:"danger",children:Object(C.jsx)("p",{children:s})})," "]}),Object(C.jsxs)(w.a.Footer,{children:[Object(C.jsx)(y.a,{variant:"secondary",onClick:n,children:"Close"}),Object(C.jsx)(y.a,{variant:"danger",onClick:function(){return a(c)},children:"Delete"})]})]})})}var T=n(40),E=n(49);function L(e){var t=e.tag,n=e.index,a=e.removeTag;return Object(C.jsxs)("li",{className:"tag",children:[Object(C.jsx)("span",{className:"tag-title",children:t}),Object(C.jsx)("span",{className:"tag-close-icon",onClick:function(){return a(n)},children:"x"})]})}function I(e){var t=e.tag,n=e.findTag;return Object(C.jsx)("li",{className:"tag",onClick:function(){return n(t)},children:Object(C.jsx)("span",{className:"tag-title",children:t})})}function P(e){var t=e.tags,n=e.setTags,a=function(e){n(Object(j.a)(t.filter((function(t,n){return n!==e}))))};return Object(C.jsxs)("div",{className:"tags-input",children:[Object(C.jsx)("ul",{id:"tags",children:t.map((function(e,t){return Object(C.jsx)(L,{tag:e,index:t,removeTag:a},t)}))}),Object(C.jsx)(E.a,{className:"mb-3",children:Object(C.jsx)(T.a,{type:"text",onKeyUp:function(e){return"Enter"===e.key?void(""!==(a=e).target.value&&(n([].concat(Object(j.a)(t),[a.target.value])),a.target.value="")):null;var a},placeholder:"Press enter to add tags"})})]})}function D(e){var t=e.show,n=e.handleClose,a=e.setSubject,c=e.setContent,s=e.setTags,r=e.handleEdit,o=e.id,i=e.subject,l=e.content,j=e.tags;return Object(C.jsx)(C.Fragment,{children:Object(C.jsxs)(w.a,{show:t,onHide:n,children:[Object(C.jsx)(w.a.Header,{closeButton:!0,children:Object(C.jsx)(w.a.Title,{children:"Edit post"})}),Object(C.jsxs)(w.a.Body,{children:[Object(C.jsx)(E.a,{className:"mb-2",children:Object(C.jsx)(T.a,{"aria-label":"Thread Subject",onChange:function(e){return a(e.target.value)},value:i||"",disabled:!0})}),Object(C.jsx)(E.a,{children:Object(C.jsx)(T.a,{as:"textarea","aria-label":"With textarea",onChange:function(e){return c(e.target.value)},value:l||""})}),Object(C.jsx)(P,{tags:j,setTags:s})]}),Object(C.jsxs)(w.a.Footer,{children:[Object(C.jsx)(y.a,{variant:"secondary",onClick:n,children:"Close"}),Object(C.jsx)(y.a,{variant:"primary",onClick:function(){return r(o)},children:"Save Changes"})]})]})})}function A(e){var t=e.show,n=e.handleClose,a=e.setContent,c=e.handleEdit,s=e.id,r=e.content;return Object(C.jsx)(C.Fragment,{children:Object(C.jsxs)(w.a,{show:t,onHide:n,children:[Object(C.jsx)(w.a.Header,{closeButton:!0,children:Object(C.jsx)(w.a.Title,{children:"Edit post"})}),Object(C.jsx)(w.a.Body,{children:Object(C.jsx)(E.a,{children:Object(C.jsx)(T.a,{as:"textarea","aria-label":"With textarea",onChange:function(e){return a(e.target.value)},value:r||""})})}),Object(C.jsxs)(w.a.Footer,{children:[Object(C.jsx)(y.a,{variant:"secondary",onClick:n,children:"Close"}),Object(C.jsx)(y.a,{variant:"primary",onClick:function(){return c(s)},children:"Save Changes"})]})]})})}function M(e){var t=Math.floor(((new Date).getTime()-new Date(e).getTime())/1e3),n=t/31536e3;return n>=1?Math.floor(n)+" years":(n=t/2592e3)>=1?Math.floor(n)+" months":(n=t/604800)>=1?Math.floor(n)+" weeks":(n=t/86400)>=1?Math.floor(n)+" days":(n=t/3600)>=1?Math.floor(n)+" hours":(n=t/60)>=1?Math.floor(n)+" minutes":Math.floor(t)+" seconds"}var B=n(63),F=n(29);function _(e){var t=e.show,n=e.setShow,a=e.variant,c=e.heading,s=e.message;return t?Object(C.jsxs)(S.a,{variant:a,onClose:function(){return n(!1)},dismissible:!0,children:[Object(C.jsx)(S.a.Heading,{children:c}),Object(C.jsx)("p",{children:s})]}):null}function H(e){var t=e.thread,n=e.displayEditModal,a=e.displayDeleteModal,c=e.findTag;return Object(C.jsxs)(h.a,{className:"thread-wrapper",children:[Object(C.jsxs)(d.a,{children:[Object(C.jsx)(b.a,{children:Object(C.jsx)("h5",{children:Object(C.jsx)(o.b,{to:"/thread/"+t.id,children:t.subject})})}),Object(C.jsxs)(b.a,{xs:{order:1},lg:1,className:"d-flex align-items-baseline justify-content-end",children:[Object(C.jsx)(B.a,{className:"edit-icon",onClick:function(){return n(t.id,t.subject,t.content,t.tags)}}),Object(C.jsx)(F.c,{className:"delete-icon",onClick:function(){return a(t.id)}})]})]}),Object(C.jsx)(d.a,{children:Object(C.jsxs)(b.a,{children:[Object(C.jsx)("p",{children:t.content}),Object(C.jsxs)("p",{className:"text-muted",children:[t.likes," likes \u2022 "," ",M(t.createdAt)," ago "," ",t.updatedAt?" \u2022 Edited "+t.updatedAt:""]}),Object(C.jsx)("ul",{id:"tags",children:t.tags?t.tags.map((function(e,t){return Object(C.jsx)(I,{tag:e,findTag:c},t)})):null})]})})]})}function J(e){var t=e.user,n=Object(a.useState)([]),c=Object(u.a)(n,2),s=c[0],r=c[1],o=Object(a.useState)(null),d=Object(u.a)(o,2),b=d[0],h=d[1],O=Object(a.useState)(!1),x=Object(u.a)(O,2),f=x[0],p=x[1],g=Object(a.useState)(!1),m=Object(u.a)(g,2),v=m[0],S=m[1],y=Object(a.useState)(null),w=Object(u.a)(y,2),T=w[0],E=w[1],L=Object(a.useState)(null),I=Object(u.a)(L,2),P=I[0],A=I[1],M=Object(a.useState)([]),B=Object(u.a)(M,2),F=B[0],J=B[1],K=Object(a.useState)(!1),U=Object(u.a)(K,2),R=U[0],q=U[1],G=Object(a.useState)(null),V=Object(u.a)(G,2),z=V[0],W=V[1],Q=Object(i.g)();function X(e){Q.push("/search?tagged=".concat(e))}Object(a.useEffect)((function(){k.get("/users/".concat(t.username,"/threads")).then((function(e){r(e.data)})).catch((function(e){console.log(e),e.response?W(e.response.data):W("Server error"),q(!0)}))}),[t.username]);var Y=function(e){h(e),p(!0)};var Z=function(e,t,n,a){h(e),E(t),A(n),J(a||[]),S(!0)};return Object(C.jsxs)("div",{className:"threads-container",children:[Object(C.jsx)(_,{message:z,heading:"Error",show:R,setShow:q,variant:"danger"}),0===s.length?Object(C.jsx)("p",{children:"No threads submitted yet."}):s.map((function(e){return Object(C.jsx)(H,{thread:e,displayDeleteModal:Y,displayEditModal:Z,findTag:X},e.id)})),Object(C.jsx)(D,{show:v,handleClose:function(){S(!1)},setSubject:E,setContent:A,setTags:J,handleEdit:function(e){var n={subject:T,content:P,tags:F};k.put("/users/".concat(t.username,"/threads/").concat(e),n).then((function(t){console.log(t),r(s.map((function(t){return t.id===e?Object(l.a)(Object(l.a)({},t),{},{subject:T,content:P,tags:F,updatedAt:"just now"}):t})))})).catch((function(e){console.log(e),e.response?W(e.response.data):W("Could not connect to server. :("),q(!0)})),S(!1)},id:b,subject:T,content:P,tags:F}),Object(C.jsx)(N,{show:f,handleClose:function(){p(!1)},handleDelete:function(e){k.delete("/users/".concat(t.username,"/threads/").concat(e)).then((function(t){console.log(t.data),r(Object(j.a)(s.filter((function(t){return t.id!==e}))))})).catch((function(e){console.log(e),e.response?W(e.response.data):W("Could not connect to the server."),q(!0)})),p(!1)},message:"Are you sure you want to delete this thread? This action is permanent and cannot be undone.",id:b})]})}var K=n(16);function U(e){e.user;var t=Object(i.j)().url,n=Object(i.g)(),c=Object(i.h)(),s=Object(a.useState)("".concat(c.pathname)),r=Object(u.a)(s,2),o=r[0],l=r[1];console.log(c.pathname);return Object(C.jsx)("div",{className:"sidebar",children:Object(C.jsxs)(K.a,{variant:"pills",defaultActiveKey:"".concat(t),activeKey:o,onSelect:function(e){!function(e){l(e),n.push(e)}(e)},className:"flex-sm-column",children:[Object(C.jsx)(K.a.Link,{eventKey:"".concat(t),children:"Home"}),Object(C.jsx)(K.a.Link,{eventKey:"".concat(t,"/threads"),children:"My Threads"}),Object(C.jsx)(K.a.Link,{eventKey:"".concat(t,"/posts"),children:"My Posts"}),Object(C.jsx)(K.a.Link,{eventKey:"".concat(t,"/liked"),children:"Liked Threads"})]})})}var R=n(87),q=n(0),G=n(88);function V(e){var t=e.tag,n=e.findByTag;return Object(C.jsx)("li",{className:"tag",onClick:function(){return n(t)},children:Object(C.jsx)("span",{className:"tag-title",children:t})})}var z=Object(a.forwardRef)((function(e,t){var n=e.thread,c=e.toggleLike,s=Object(i.g)(),r=function(e){s.push("/search?tagged=".concat(e))};return Object(a.useEffect)((function(){if(t)return function(){return t(null)}}),[t]),Object(C.jsx)("div",{className:"thread-wrapper",ref:t,children:Object(C.jsx)("div",{className:"d-flex flex-row",children:Object(C.jsxs)("div",{className:"d-flex flex-column",children:[Object(C.jsx)("p",{children:Object(C.jsx)("b",{children:n.author})}),Object(C.jsx)("h5",{children:Object(C.jsx)(o.b,{to:"/thread/"+n.id,children:n.subject})}),Object(C.jsx)("p",{children:n.content}),Object(C.jsxs)("p",{className:"text-muted",children:[Object(C.jsx)(q.b.Provider,{value:{className:"comment-icon"},children:Object(C.jsx)(R.a,{onClick:function(){return s.push("/thread/".concat(n.id))}})})," ",n.comments," comments \u2022 ",Object(C.jsx)(q.b.Provider,{value:{className:n.userLiked?"heart-icon-liked":"heart-icon"},children:Object(C.jsx)(F.b,{onClick:function(){return c(n.userLiked,n.id)}})})," ",n.likes," likes \u2022 ",M(n.createdAt)," ago"]}),Object(C.jsx)("ul",{id:"tags",children:n.tags?n.tags.map((function(e,t){return Object(C.jsx)(V,{tag:e,findByTag:r},t)})):null})]})})})}));function W(e){var t=e.user,n=Object(a.useState)([]),c=Object(u.a)(n,2),s=c[0],r=c[1],o=Object(a.useState)(1),d=Object(u.a)(o,2),b=d[0],O=d[1],x=Object(a.useState)("new"),f=Object(u.a)(x,2),p=f[0],m=f[1],v=Object(a.useState)(!0),S=Object(u.a)(v,2),y=S[0],w=S[1],N=Object(a.useState)(!1),T=Object(u.a)(N,2),E=T[0],L=T[1],I=Object(a.useState)(!1),P=Object(u.a)(I,2),D=P[0],A=P[1],M=Object(i.g)(),B=Object(a.useRef)(),F=Object(a.useCallback)((function(e){y||(B.current&&B.current.disconnect(),B.current=new IntersectionObserver((function(e){e[0].isIntersecting&&D&&O((function(e){return e+1}))})),e&&B.current.observe(e))}),[y,D]);Object(a.useEffect)((function(){w(!0),L(!1);var e=g.a.CancelToken.source(),t=e.token;return k.get("/threads?page=".concat(b-1,"&size=").concat(5,"&sort=").concat(p),{cancelToken:t}).then((function(e){r((function(t){return Object(j.a)(new Set([].concat(Object(j.a)(t),Object(j.a)(e.data.threads))))})),A(e.data.pageCount>0),w(!1)})).catch((function(e){g.a.isCancel(e)?console.log("Request cancelled "+e.message):(console.log(e),L(!0))})),function(){e.cancel("cancel pweease")}}),[b,p]);function _(e,n){t.token?e?k.delete("/users/".concat(t.username,"/liked/").concat(n)).then((function(e){console.log(e.data),r(s.map((function(e){return e.id===n?Object(l.a)(Object(l.a)({},e),{},{likes:e.likes-1,userLiked:!1}):e})))})).catch((function(e){console.log(e)})):k.post("/users/".concat(t.username,"/liked/").concat(n)).then((function(e){console.log(e.data),r(s.map((function(e){return e.id===n?Object(l.a)(Object(l.a)({},e),{},{likes:e.likes+1,userLiked:!0}):e})))})).catch((function(e){console.log(e)})):M.push("/login")}var H=s.map((function(e,t){return t+1===s.length?Object(C.jsx)(z,{thread:e,toggleLike:_,ref:F},e.id):Object(C.jsx)(z,{thread:e,toggleLike:_},e.id)}));return Object(C.jsxs)(h.a,{fluid:!0,className:"thread-container",children:[Object(C.jsxs)(K.a,{variant:"pills",className:"justify-content-center mt-2",activeKey:"".concat(p),onSelect:function(e){return function(e){e!==p&&r([]),O(1),m(e),w(!0),L(!1)}(e)},children:[Object(C.jsx)(K.a.Item,{children:Object(C.jsx)(K.a.Link,{eventKey:"new",children:"New"})}),Object(C.jsx)(K.a.Item,{children:Object(C.jsx)(K.a.Link,{eventKey:"popular",children:"Popular"})}),Object(C.jsx)(K.a.Item,{children:Object(C.jsx)(K.a.Link,{eventKey:"old",children:"Old"})})]}),H,Object(C.jsx)("div",{children:y&&Object(C.jsx)(G.a,{animation:"border",role:"status",children:Object(C.jsx)("span",{className:"sr-only",children:"Loading..."})})}),Object(C.jsx)("div",{children:E&&"Error"})]})}function Q(e){var t=e.post,n=e.displayEditModal,a=e.displayDeleteModal;return Object(C.jsxs)(h.a,{className:"thread-wrapper",children:[Object(C.jsxs)(d.a,{children:[Object(C.jsx)(b.a,{children:Object(C.jsx)("b",{children:Object(C.jsx)(o.b,{to:"/thread/"+t.threadId,children:t.threadSubject})})}),Object(C.jsxs)(b.a,{xs:{order:1},lg:1,className:"d-flex align-items-baseline justify-content-end",children:[Object(C.jsx)(B.a,{className:"edit-icon",onClick:function(){return n(t.id,t.content)}}),Object(C.jsx)(F.c,{className:"delete-icon",onClick:function(){return a(t.id)}})]})]}),Object(C.jsx)(d.a,{children:Object(C.jsxs)(b.a,{md:"auto",children:[Object(C.jsx)("p",{children:t.content}),Object(C.jsxs)("p",{className:"text-muted",children:[M(t.createdAt)," ago ",t.updatedAt?"\u2022 Edited "+t.updatedAt:""]})]})})]})}function X(e){var t=e.user,n=Object(a.useState)([]),c=Object(u.a)(n,2),s=c[0],r=c[1],o=Object(a.useState)(!1),i=Object(u.a)(o,2),d=i[0],b=i[1],O=Object(a.useState)(!1),x=Object(u.a)(O,2),f=x[0],p=x[1],g=Object(a.useState)(null),m=Object(u.a)(g,2),v=m[0],S=m[1],y=Object(a.useState)(null),w=Object(u.a)(y,2),T=w[0],E=w[1],L=Object(a.useState)(null),I=Object(u.a)(L,2),P=I[0],D=I[1],M=Object(a.useState)(!1),B=Object(u.a)(M,2),F=B[0],H=B[1];Object(a.useEffect)((function(){k.get("/users/".concat(t.username,"/posts")).then((function(e){H(!1),r(e.data)})).catch((function(e){console.log(e),e.response?D(e.response.data):D("Server error. Could not retrieve posts."),H(!0)}))}),[t.username]);var J=function(e){E(e),b(!0)};var K=function(e,t){E(e),S(t),p(!0)};return Object(C.jsxs)(h.a,{children:[Object(C.jsx)(_,{show:F,setShow:H,variant:"danger",heading:"Error",message:P}),0===s.length?Object(C.jsx)("p",{children:"No posts found."}):s.map((function(e){return Object(C.jsx)(Q,{post:e,displayEditModal:K,displayDeleteModal:J},e.id)})),Object(C.jsx)(A,{show:f,handleClose:function(){p(!1)},setContent:S,handleEdit:function(e){var n={content:v};k.put("/users/".concat(t.username,"/posts/").concat(e),n).then((function(t){console.log(t),H(!1),r(s.map((function(t){return t.id===e?Object(l.a)(Object(l.a)({},t),{},{content:v,updatedAt:"just now"}):t})))})).catch((function(e){console.log(e),e.response?D(e.response.data):D("Could not connect to server"),H(!0)})),p(!1)},id:T,content:v}),Object(C.jsx)(N,{show:d,handleClose:function(){b(!1)},handleDelete:function(e){k.delete("/users/".concat(t.username,"/posts/").concat(e)).then((function(t){console.log(t.data),H(!1),r(Object(j.a)(s.filter((function(t){return t.id!==e}))))})).catch((function(e){console.log(e),e.response?D("Server error"):D(e.response.data),H(!0)})),b(!1)},message:"Are you sure you want to delete this post? This action is permanent and cannot be undone.",id:T})]})}function Y(e){var t=e.like,n=e.unlike;return Object(C.jsxs)("div",{className:"thread-wrapper",children:[Object(C.jsx)("p",{children:Object(C.jsx)("b",{children:t.threadAuthor})}),Object(C.jsx)(o.b,{to:"/thread/".concat(t.threadId),children:Object(C.jsx)("h6",{children:t.threadSubject})}),Object(C.jsxs)("p",{className:"text-muted",children:[Object(C.jsx)(q.b.Provider,{value:{className:"heart-icon-liked"},children:Object(C.jsx)(F.b,{onClick:function(){return n(t.threadId)}})})," Liked ",M(t.createdAt)," ago"]})]})}function Z(e){var t=e.user,n=Object(a.useState)([]),c=Object(u.a)(n,2),s=c[0],r=c[1],o=Object(a.useState)(null),i=Object(u.a)(o,2),l=(i[0],i[1]);function d(e){k.delete("/users/".concat(t.username,"/liked/").concat(e)).then((function(t){console.log(t.data),r(Object(j.a)(s.filter((function(t){return t.threadId!==e}))))})).catch((function(e){console.log(e),l(e)}))}return Object(a.useEffect)((function(){var e=g.a.CancelToken.source(),n=e.token;return k.get("/users/".concat(t.username,"/liked"),{cancelToken:n}).then((function(e){console.log(e.data),r(e.data)})).catch((function(e){g.a.isCancel(e)?console.log("Request cancelled "+e.message):(console.log(e),l(e))})),function(){e.cancel("personally cancelled")}}),[t.username]),Object(C.jsx)("div",{children:s.map((function(e){return Object(C.jsx)(Y,{like:e,unlike:d},e.id)}))})}var $=n(64),ee=["children","user"];var te=function(e){var t=e.children,n=e.user,a=Object($.a)(e,ee);return Object(C.jsx)(i.b,Object(l.a)(Object(l.a)({},a),{},{render:function(e){var a=e.location;return n.token?t:Object(C.jsx)(i.a,{to:{pathname:"/login",state:{from:a}}})}}))};function ne(e){var t=e.tag,n=e.index;return Object(C.jsx)(o.b,{to:"/search?tagged=".concat(t.id),children:Object(C.jsxs)("p",{children:[Object(C.jsxs)("b",{children:["#",n+1]})," ",t.id]})})}function ae(){var e=Object(a.useState)([]),t=Object(u.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)((function(){k.get("/tags/top").then((function(e){console.log(e),c(e.data)})).catch((function(e){console.log(e)}))}),[]),Object(C.jsx)("div",{className:"round-box",children:Object(C.jsxs)("div",{className:"tags-box",children:[Object(C.jsx)("h6",{children:"Top Tags"}),n.map((function(e,t){return Object(C.jsx)(ne,{tag:e,index:t},e.id)}))]})})}function ce(e){var t=e.user,n=Object(i.j)().path,a=Object(i.g)();return Object(C.jsx)(h.a,{fluid:!0,className:"homepage",children:Object(C.jsxs)(d.a,{className:"justify-content-center",children:[Object(C.jsx)(b.a,{lg:{order:12},children:Object(C.jsx)("div",{className:"right-button",children:Object(C.jsx)(y.a,{onClick:function(){a.push("/create")},children:"Create new thread"})})}),Object(C.jsx)(b.a,{children:Object(C.jsx)(U,{user:t})}),Object(C.jsx)(b.a,{xl:8,children:Object(C.jsxs)(i.d,{children:[Object(C.jsx)(i.b,{exact:!0,path:n,children:Object(C.jsx)(W,{user:t})}),Object(C.jsx)(te,{user:t,path:"".concat(n,"/threads"),children:Object(C.jsx)(J,{user:t})}),Object(C.jsx)(te,{user:t,path:"".concat(n,"/posts"),children:Object(C.jsx)(X,{user:t})}),Object(C.jsx)(te,{user:t,path:"".concat(n,"/liked"),children:Object(C.jsx)(Z,{user:t})})]})})]})})}function se(){return Object(C.jsx)("h2",{children:"Preferences"})}n(69);var re=n(12);function oe(e){return ie.apply(this,arguments)}function ie(){return(ie=Object(f.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",k.post("/auth/login",{username:t.username,password:t.password}).then((function(e){return e.data})).catch((function(e){throw 500===e.response.status?new Error("Server error"):new Error("Username/password is invalid")})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function le(e){var t=e.setToken,n=Object(a.useState)(),c=Object(u.a)(n,2),s=c[0],r=c[1],o=Object(a.useState)(),i=Object(u.a)(o,2),l=i[0],j=i[1],O=Object(a.useState)(!1),p=Object(u.a)(O,2),g=p[0],m=p[1],v=Object(a.useState)(null),k=Object(u.a)(v,2),S=k[0],w=k[1],N=Object(a.useState)(!1),T=Object(u.a)(N,2),E=T[0],L=T[1],I=function(){var e=Object(f.a)(x.a.mark((function e(n){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!1===n.currentTarget.checkValidity()&&(n.preventDefault(),n.stopPropagation()),m(!0),n.preventDefault(),e.prev=4,e.next=7,oe({username:s,password:l});case 7:a=e.sent,t(a),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(4),w(e.t0.message),L(!0);case 15:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){return function(){m(!1)}}),[]),Object(C.jsx)(h.a,{children:Object(C.jsx)(d.a,{className:"justify-content-center",children:Object(C.jsx)(b.a,{lg:4,children:Object(C.jsxs)("div",{className:"round-box",children:[Object(C.jsx)(_,{show:E,variant:"danger",message:S,setShow:L,heading:"Error"}),Object(C.jsx)("h1",{children:"Log In"}),Object(C.jsxs)(re.a,{noValidate:!0,validated:g,onSubmit:I,children:[Object(C.jsxs)(re.a.Group,{controlId:"formBasicUsername",children:[Object(C.jsx)(re.a.Label,{children:"Username"}),Object(C.jsx)(re.a.Control,{required:!0,type:"text",placeholder:"Enter username",onChange:function(e){return r(e.target.value)}}),Object(C.jsx)(re.a.Control.Feedback,{type:"invalid",children:"Please enter a username."})]}),Object(C.jsxs)(re.a.Group,{controlId:"formBasicPassword",children:[Object(C.jsx)(re.a.Label,{children:"Password"}),Object(C.jsx)(re.a.Control,{required:!0,type:"password",placeholder:"Password",onChange:function(e){return j(e.target.value)}}),Object(C.jsx)(re.a.Control.Feedback,{type:"invalid",children:"Please enter a password."})]}),Object(C.jsx)(y.a,{variant:"primary",type:"submit",block:!0,children:"Submit"}),Object(C.jsxs)(re.a.Text,{id:"loginHelpInline",muted:!0,children:["Don't have an account? ",Object(C.jsx)("a",{href:"/signup",children:"Sign up here."})]})]})]})})})})}function je(e){var t=e.user;return Object(C.jsx)(h.a,{fluid:!0,className:"homepage",children:Object(C.jsxs)(d.a,{children:[Object(C.jsx)(b.a,{xl:9,children:Object(C.jsx)(W,{user:t})}),Object(C.jsx)(b.a,{xl:3,className:"d-none d-md-block",children:Object(C.jsx)(h.a,{fluid:!0,className:"right-button",children:Object(C.jsx)(ae,{})})})]})})}var ue=["children","restricted","user"],de=function(e){var t=e.children,n=e.restricted,a=e.user,c=Object($.a)(e,ue);return Object(C.jsx)(i.b,Object(l.a)(Object(l.a)({},c),{},{render:function(e){var c=e.location;return a.token&&n?Object(C.jsx)(i.a,{to:{pathname:"/dashboard",state:{from:c}}}):t}}))},be=n(43),he=function(e,t){return t.reset?{username:"",password:""}:Object(l.a)(Object(l.a)({},e),{},Object(be.a)({},t.name,t.value))};function Oe(){var e=Object(a.useReducer)(he,{}),t=Object(u.a)(e,2),n=t[0],c=t[1],s=Object(i.g)(),r=Object(a.useState)(!1),o=Object(u.a)(r,2),l=o[0],j=o[1],O=Object(a.useState)(null),x=Object(u.a)(O,2),f=x[0],p=x[1],g=Object(a.useState)(!1),m=Object(u.a)(g,2),v=m[0],S=m[1],w=function(e){c({name:e.target.name,value:e.target.value})};return Object(C.jsxs)(h.a,{children:[Object(C.jsx)(d.a,{className:"justify-content-center",children:Object(C.jsx)(b.a,{lg:5,children:Object(C.jsx)(_,{show:v,setShow:S,variant:"danger",heading:"Error",message:f})})}),Object(C.jsx)(d.a,{className:"justify-content-center",children:Object(C.jsx)(b.a,{lg:4,children:Object(C.jsxs)("div",{className:"round-box",children:[Object(C.jsx)("h1",{children:"Sign Up"}),Object(C.jsxs)(re.a,{noValidate:!0,validated:l,onSubmit:function(e){!1===e.currentTarget.checkValidity()&&(e.preventDefault(),e.stopPropagation()),j(!0),e.preventDefault();var t={username:n.username,password:n.password};k.post("http://localhost:8080/api/v1/auth/signup",t).then((function(e){console.log(e.data),s.push("/login")})).catch((function(e){console.log(e.response),p(e.response.data),S(!0),c({reset:!0})}))},children:[Object(C.jsxs)(re.a.Group,{controlId:"formBasicUsername",children:[Object(C.jsx)(re.a.Label,{children:"Username"}),Object(C.jsx)(re.a.Control,{required:!0,name:"username",type:"text",onChange:w,value:n.username||""}),Object(C.jsx)(re.a.Control.Feedback,{type:"invalid",children:"Username cannot be blank."})]}),Object(C.jsxs)(re.a.Group,{controlId:"formBasicPassword",children:[Object(C.jsx)(re.a.Label,{children:"Password"}),Object(C.jsx)(re.a.Control,{required:!0,name:"password",type:"password",onChange:w,value:n.password||""}),Object(C.jsx)(re.a.Control.Feedback,{type:"invalid",children:"Password cannot be blank."})]}),Object(C.jsx)("div",{className:"pb-3",children:Object(C.jsx)(y.a,{variant:"primary",type:"submit",block:!0,children:"Submit"})})]})]})})})]})}function xe(e){var t=e.show,n=e.handleClose,a=e.setContent,c=e.handleSubmit;return Object(C.jsx)(C.Fragment,{children:Object(C.jsxs)(w.a,{show:t,onHide:n,children:[Object(C.jsx)(w.a.Header,{closeButton:!0,children:Object(C.jsx)(w.a.Title,{children:"Create post"})}),Object(C.jsx)(w.a.Body,{children:Object(C.jsx)(E.a,{className:"mb-3",children:Object(C.jsx)(T.a,{as:"textarea","aria-label":"textarea",placeholder:"Share your thoughts here...",onChange:function(e){return a(e.target.value)}})})}),Object(C.jsxs)(w.a.Footer,{children:[Object(C.jsx)(y.a,{variant:"secondary",onClick:n,children:"Close"}),Object(C.jsx)(y.a,{variant:"primary",onClick:c,children:"Submit"})]})]})})}function fe(e){var t=e.user,n=e.post,a=e.displayEditModal,c=e.displayDeleteModal;return Object(C.jsxs)("div",{className:"post-wrapper",children:[Object(C.jsx)("b",{children:n.author}),Object(C.jsx)("p",{children:n.content}),Object(C.jsxs)("small",{className:"text-muted",children:[M(n.createdAt)," ago"]}),Object(C.jsx)("span",{children:Object(C.jsx)("small",{className:"text-muted",children:n.updatedAt?" Edited "+n.updatedAt:""})}),t.username===n.author?Object(C.jsxs)("span",{children:[Object(C.jsx)("span",{className:"edit-span",onClick:function(){return a(n.id,n.content)},children:Object(C.jsx)("small",{children:" Edit "})}),Object(C.jsx)("span",{className:"delete-span",onClick:function(){return c(n.id)},children:Object(C.jsx)("small",{children:"Delete"})})]}):null]})}function pe(e){var t=e.tag,n=e.findByTag;return Object(C.jsx)("li",{className:"tag",onClick:function(){return n(t)},children:Object(C.jsx)("span",{className:"tag-title",children:t})})}function ge(e){var t=e.user,n=Object(a.useState)(null),c=Object(u.a)(n,2),s=c[0],r=c[1],o=Object(a.useState)([]),d=Object(u.a)(o,2),b=d[0],O=d[1],x=Object(a.useState)(!1),f=Object(u.a)(x,2),p=f[0],g=f[1],m=Object(a.useState)(!1),v=Object(u.a)(m,2),S=v[0],w=v[1],T=Object(a.useState)(!1),E=Object(u.a)(T,2),L=E[0],I=E[1],P=Object(a.useState)(null),D=Object(u.a)(P,2),B=D[0],H=D[1],J=Object(a.useState)(null),K=Object(u.a)(J,2),U=K[0],R=K[1],G=Object(a.useState)(!1),V=Object(u.a)(G,2),z=V[0],W=V[1],Q=Object(a.useState)(!1),X=Object(u.a)(Q,2),Y=X[0],Z=X[1],$=Object(a.useState)(!1),ee=Object(u.a)($,2),te=ee[0],ne=ee[1],ae=Object(i.i)().id,ce=Object(i.g)();if(Object(a.useEffect)((function(){k.get("/threads/".concat(ae)).then((function(e){r(e.data)})).catch((function(e){console.log(e)})),t.token&&k.get("/users/".concat(t.username,"/threads/").concat(ae,"/likes")).then((function(e){404===e.status?W(!1):W(!0)})).catch((function(e){console.log(e)})),k.get("/threads/".concat(ae,"/posts")).then((function(e){O(e.data)})).catch((function(e){console.log(e)}))}),[ae,t.username,t.token]),!s)return null;var se=function(e,t){R(e),H(t),g(!0)},re=function(e){R(e),I(!0)};function oe(e){ce.push("/search?tagged=".concat(e))}return Object(C.jsxs)(h.a,{fluid:!0,children:[Object(C.jsxs)("div",{className:"thread-wrapper",children:[Object(C.jsx)("p",{children:Object(C.jsx)("b",{children:s.author})}),Object(C.jsx)("h3",{className:"mb-3",children:s.subject}),Object(C.jsx)("p",{children:s.content}),Object(C.jsxs)("p",{className:"text-muted",children:[Object(C.jsx)(q.b.Provider,{value:{className:z?"heart-icon-liked":"heart-icon"},children:Object(C.jsx)(F.b,{onClick:function(){return function(e){t.token?e?k.delete("/users/".concat(t.username,"/liked/").concat(ae)).then((function(e){console.log(e.data),W(!1),r(Object(l.a)(Object(l.a)({},s),{},{likes:s.likes-1}))})).catch((function(e){console.log(e)})):k.post("/users/".concat(t.username,"/liked/").concat(ae)).then((function(e){console.log(e.data),W(!0),r(Object(l.a)(Object(l.a)({},s),{},{likes:s.likes+1}))})).catch((function(e){console.log(e)})):ce.push("/login")}(z)}})})," ",s.likes," likes \u2022 ",M(s.createdAt)," ago"]}),Object(C.jsx)("ul",{id:"tags",children:s.tags?s.tags.map((function(e,t){return Object(C.jsx)(pe,{tag:e,findByTag:oe},t)})):null})]}),Object(C.jsx)("div",{className:"thread-bar",children:Object(C.jsx)(y.a,{variant:"primary",onClick:function(){t.token?w(!0):ce.push("/login")},children:"Reply"})}),Object(C.jsx)(_,{show:te,setShow:ne,variant:"danger",heading:"Error",message:Y}),Object(C.jsx)("div",{className:"thread-wrapper",children:0===b.length?Object(C.jsx)("p",{children:"No posts yet..."}):b.map((function(e){return Object(C.jsx)(fe,{post:e,displayEditModal:se,displayDeleteModal:re,user:t},e.id)}))}),Object(C.jsx)(A,{show:p,handleClose:function(){g(!1)},setContent:H,handleEdit:function(e){var n={content:B};k.put("/users/".concat(t.username,"/posts/").concat(e),n).then((function(t){console.log(t.data),O(b.map((function(t){return t.id===e?Object(l.a)(Object(l.a)({},t),{},{content:B,updatedAt:"just now"}):t})))})).catch((function(e){console.log(e),Z(e.response.data),ne(!0)})),g(!1)},id:U,content:B}),Object(C.jsx)(N,{show:L,handleClose:function(){I(!1)},handleDelete:function(e){k.delete("/users/".concat(t.username,"/posts/").concat(e)).then((function(t){console.log(t.data),O(Object(j.a)(b.filter((function(t){return t.id!==e}))))})).catch((function(e){console.log(e),Z(e.response.data),ne(!0)})),I(!1)},message:"Are you sure you want to delete this post? This action is permanent and cannot be undone.",id:U}),Object(C.jsx)(xe,{show:S,handleClose:function(){w(!1)},setContent:H,handleSubmit:function(){var e={content:B,threadId:ae};k.post("/users/".concat(t.username,"/posts"),e).then((function(e){console.log(e.data),O([].concat(Object(j.a)(b),[e.data]))})).catch((function(e){console.log(e),Z(e.response.data),ne(!0)})),w(!1)}})]})}var me=n(34);function ve(){var e=Object(i.g)(),t=Object(a.useState)(""),n=Object(u.a)(t,2),c=n[0],s=n[1];return Object(C.jsx)("div",{className:"search-bar",children:Object(C.jsx)(T.a,{type:"text",placeholder:"Search tag...",className:"mr-sm-2",value:c,onChange:function(e){return function(e){s(e.target.value)}(e)},onKeyUp:function(t){return"Enter"===t.key?function(t){e.push("/search?tagged=".concat(t.target.value))}(t):null}})})}function ke(e){var t=e.user,n=Object(i.g)();return t.token?Object(C.jsxs)(me.a,{bg:"light",variant:"light",expand:"lg",className:"navbar-wrapper",children:[Object(C.jsx)(me.a.Brand,{href:"/",children:"Forum"}),Object(C.jsx)(me.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(C.jsxs)(me.a.Collapse,{id:"basic-navbar-nav",children:[Object(C.jsxs)(K.a,{className:"mr-auto",children:[Object(C.jsx)(K.a.Link,{href:"/",children:"Home"}),Object(C.jsx)(K.a.Link,{href:"/dashboard",children:"Dashboard"}),Object(C.jsx)(K.a.Link,{href:"/create",children:"Create a new thread"})]}),Object(C.jsx)(ve,{}),Object(C.jsx)(K.a,{className:"pr-2",children:Object(C.jsxs)(me.a.Text,{children:["Signed in as: ",Object(C.jsx)("a",{href:"/dashboard",children:t.username})]})}),Object(C.jsx)(y.a,{variant:"danger",onClick:function(){sessionStorage.clear(),window.location.href="/"},children:"Log Out"})]})]}):Object(C.jsxs)(me.a,{bg:"light",variant:"light",expand:"lg",className:"navbar-wrapper",children:[Object(C.jsx)(me.a.Brand,{href:"/",children:"Forum"}),Object(C.jsx)(me.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(C.jsxs)(me.a.Collapse,{id:"basic-navbar-nav",children:[Object(C.jsx)(K.a,{className:"mr-auto",children:Object(C.jsx)(K.a.Link,{href:"/",children:"Home"})}),Object(C.jsx)(ve,{}),Object(C.jsx)(y.a,{variant:"success",onClick:function(){n.push("/login")},children:"Login"})]})]})}var Se=function(e,t){return Object(l.a)(Object(l.a)({},e),{},Object(be.a)({},t.name,t.value))};function ye(e){var t=e.user,n=Object(a.useReducer)(Se,{}),c=Object(u.a)(n,2),s=c[0],r=c[1],o=Object(a.useState)([]),l=Object(u.a)(o,2),j=l[0],O=l[1],x=Object(i.g)(),f=Object(a.useState)(!1),p=Object(u.a)(f,2),g=p[0],m=p[1],v=Object(a.useState)(null),S=Object(u.a)(v,2),w=S[0],N=S[1],T=Object(a.useState)(!1),E=Object(u.a)(T,2),L=E[0],I=E[1],D=function(e){!1===e.currentTarget.checkValidity()&&(e.preventDefault(),e.stopPropagation()),m(!0),e.preventDefault();var n={subject:s.subject,content:s.content,tags:j};k.post("/users/".concat(t.username,"/threads"),n).then((function(e){console.log(e.data),x.push("/thread/".concat(e.data.id))})).catch((function(e){console.log(e),N(e.response.data),I(!0)}))},A=function(e){e.preventDefault(),r({name:e.target.name,value:e.target.value})};return Object(C.jsx)(h.a,{children:Object(C.jsx)(d.a,{className:"justify-content-center",children:Object(C.jsxs)(b.a,{lg:6,children:[Object(C.jsx)(_,{show:L,setShow:I,variant:"danger",heading:"Error creating thread",message:w}),Object(C.jsxs)("div",{className:"round-box",children:[Object(C.jsx)("h3",{children:"Create New Thread"}),Object(C.jsxs)(re.a,{noValidate:!0,validated:g,onSubmit:D,children:[Object(C.jsxs)(re.a.Group,{children:[Object(C.jsx)(re.a.Control,{required:!0,name:"subject",placeholder:"Subject","aria-label":"Subject","aria-describedby":"basic-addon1",onChange:A,value:s.subject||""}),Object(C.jsx)(re.a.Control.Feedback,{type:"invalid",children:"Subject cannot be blank."})]}),Object(C.jsx)(re.a.Group,{className:"mb-3",children:Object(C.jsx)(re.a.Control,{as:"textarea",rows:"4",name:"content",placeholder:"Content","aria-label":"Content","aria-describedby":"basic-addon1",onChange:A,value:s.content||""})}),Object(C.jsx)(P,{tags:j,setTags:O}),Object(C.jsx)(y.a,{variant:"primary",type:"button",onClick:D,children:"Submit"})]})]})]})})})}function we(e){var t=e.thread;return Object(C.jsxs)("div",{className:"thread-wrapper",children:[Object(C.jsx)(o.b,{to:"/thread/"+t.id,children:t.subject}),Object(C.jsxs)("p",{children:["by ",t.author," at ",t.createdAt]})]})}function Ce(){var e=new URLSearchParams(Object(i.h)().search),t=Object(a.useState)(e.get("tagged")),n=Object(u.a)(t,2),c=n[0],s=n[1],r=Object(a.useState)([]),o=Object(u.a)(r,2),l=o[0],j=o[1];return Object(a.useEffect)((function(){s(e.get("tagged")),console.log(c)}),[e,c]),Object(a.useEffect)((function(){k.get("/threads?tagged=".concat(c)).then((function(e){console.log(e.data),j(e.data)})).catch((function(e){console.log(e)}))}),[c]),Object(C.jsx)(h.a,{fluid:!0,className:"thread-container",children:l.length>0?l.map((function(e){return Object(C.jsx)(we,{thread:e},e.id)})):Object(C.jsx)("p",{children:"No threads found!"})})}function Ne(){return Object(C.jsx)("h1",{children:"Not Found"})}function Te(){return Object(C.jsx)("footer",{className:"footer",children:Object(C.jsxs)("div",{className:"container",children:[Object(C.jsx)("span",{className:"text-muted",children:"\xa9 2021"}),Object(C.jsx)(F.a,{className:"github-icon",onClick:function(){return window.open("https://github.com/mistyau","_blank").focus()}})]})})}var Ee=function(){var e=function(){var e=Object(a.useState)(function(){var e=sessionStorage.getItem("token"),t=sessionStorage.getItem("username"),n=sessionStorage.getItem("refresh_token");return{token:JSON.parse(e),username:JSON.parse(t),refresh_token:JSON.parse(n)}}()),t=Object(u.a)(e,2),n=t[0],c=t[1];return{setToken:function(e){sessionStorage.setItem("token",JSON.stringify(e.access_token)),sessionStorage.setItem("username",JSON.stringify(e.username)),sessionStorage.setItem("refresh_token",JSON.stringify(e.refresh_token)),c({token:e.access_token,username:e.username,refresh_token:e.refresh_token})},token:n}}(),t=e.token,n=e.setToken;return Object(C.jsxs)("div",{className:"wrapper",children:[Object(C.jsxs)(o.a,{basename:"forum-react-app",children:[Object(C.jsx)(ke,{user:t}),Object(C.jsxs)(i.d,{children:[Object(C.jsx)(de,{restricted:!1,user:t,path:"/",exact:!0,children:Object(C.jsx)(je,{user:t})}),Object(C.jsx)(de,{restricted:!1,user:t,path:"/thread/:id",children:Object(C.jsx)(ge,{user:t})}),Object(C.jsx)(de,{restricted:!1,user:t,path:"/search",children:Object(C.jsx)(Ce,{})}),Object(C.jsx)(de,{restricted:!0,user:t,path:"/signup",children:Object(C.jsx)(Oe,{})}),Object(C.jsx)(de,{restricted:!0,user:t,path:"/login",children:Object(C.jsx)(le,{setToken:n})}),Object(C.jsx)(te,{user:t,path:"/dashboard",children:Object(C.jsx)(ce,{user:t})}),Object(C.jsx)(te,{user:t,path:"/create",children:Object(C.jsx)(ye,{user:t})}),Object(C.jsx)(te,{user:t,path:"/preferences",children:Object(C.jsx)(se,{})}),Object(C.jsx)(i.b,{path:"*",children:Object(C.jsx)(Ne,{})})]})]}),Object(C.jsx)(Te,{})]})},Le=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,126)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,s=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),s(e),r(e)}))};!function(e){if("/"===e.search[1]){var t=e.search.slice(1).split("&").map((function(e){return e.replace(/~and~/g,"&")})).join("?");window.history.replaceState(null,null,e.pathname.slice(0,-1)+t+e.hash)}}(window.location),r.a.render(Object(C.jsx)(c.a.StrictMode,{children:Object(C.jsx)(Ee,{})}),document.getElementById("root")),Le()},69:function(e,t,n){},93:function(e,t,n){},94:function(e,t,n){}},[[123,1,2]]]);
//# sourceMappingURL=main.cbd6d2de.chunk.js.map